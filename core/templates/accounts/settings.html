{% extends 'base.html' %}
{% load widget_tweaks %}
{% load static %}
{% block title %}Account Settings · better5e{% endblock %}
{% block content %}
<div class="max-w-2xl mx-auto">
  <div class="card bg-base-100 shadow">
    <div class="card-body">
      <h2 class="card-title">Account Settings</h2>

      <div class="mt-2 space-y-2">
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm opacity-70">Username</div>
            <div class="font-medium">{{ request.user.username }}</div>
          </div>
        </div>

        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm opacity-70">Email</div>
            <div class="font-medium">{{ request.user.email|default:'—' }}</div>
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <h3 class="font-semibold">Dice Appearance</h3>
      <form method="post" class="grid gap-3 mt-2">
        {% csrf_token %}
        <input type="hidden" name="_section" value="dice" />
        <div class="form-control">
          <label class="label"><span class="label-text">Color preset</span></label>
          {{ dice_form.dice_preset|add_class:"select select-bordered" }}
          <div class="text-xs opacity-70 mt-1">Used when no external theme is set.</div>
          {{ dice_form.dice_preset.errors }}
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text">Finish</span></label>
          {{ dice_form.dice_finish|add_class:"select select-bordered" }}
          {{ dice_form.dice_finish.errors }}
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text">External theme URL (optional)</span></label>
          <div class="flex gap-2">
            {{ dice_form.dice_external_theme_url|add_class:"input input-bordered grow" }}
            <button id="diceThemeTestBtn" type="button" class="btn btn-ghost" data-test-url="{% url 'core:dice_theme_test' %}">Test</button>
          </div>
          <label class="label"><span class="label-text-alt">{{ dice_form.dice_external_theme_url.help_text }}</span></label>
          {{ dice_form.dice_external_theme_url.errors }}
        </div>
        <button type="submit" class="btn btn-primary">Save</button>
      </form>

      <div id="diceThemeAlerts" class="mt-3 space-y-2"></div>

      <div class="divider"></div>

      <div class="flex flex-wrap gap-2">
        <a href="{% url 'password_change' %}" class="btn btn-ghost">Change password</a>
        <form method="post" action="{% url 'logout' %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-outline">Logout</button>
        </form>
      </div>
    </div>
  </div>
  
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{% static 'accounts/js/settings.js' %}"></script>
{% endblock %}

