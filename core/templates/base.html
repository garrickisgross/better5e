{% load static %}
<!doctype html>
<html data-theme="cupcake" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}better5e{% endblock %}</title>

    <!-- Early theme apply to prevent flash -->
    <script>
      try {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme) document.documentElement.setAttribute("data-theme", savedTheme);
      } catch (_) {}
    </script>
    <!-- Dice prefs from server (for JS) -->
    <script id="dice-user-prefs" type="application/json">
      {"preset": "{% if request.user.is_authenticated %}{{ request.user.dice_preset|default:'amethyst' }}{% else %}amethyst{% endif %}",
       "finish": "{% if request.user.is_authenticated %}{{ request.user.dice_finish|default:'glossy' }}{% else %}glossy{% endif %}",
       "externalThemeUrl": "{% if request.user.is_authenticated %}{{ request.user.dice_external_theme_url|default:'' }}{% else %}{% endif %}"}
    </script>

    <!-- Tailwind + daisyUI (CDN dev version) -->
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 3D Dice (DiceBox) styles -->
    <link rel="stylesheet" href="https://unpkg.com/@3d-dice/dice-box@1.1.4/dist/style.css" />

    <link rel="stylesheet" href="{% static 'css/site.css' %}">
  </head>
  <body class="min-h-dvh bg-base-200">
    {% include 'partials/navbar.html' %}

    {% include 'partials/messages.html' %}

    <!-- Main content -->
    <main class="container mx-auto p-4">
      {% block content %}{% endblock %}
    </main>

    {% include 'partials/dice_panel.html' %}

    {% block extra_scripts %}{% endblock %}
    <script src="{% static 'js/theme.js' %}"></script>
    <script src="{% static 'js/dice.js' %}"></script>
  </body>
</html>
